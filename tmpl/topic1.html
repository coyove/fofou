<div class="topic">
    {{if .ID}}
    <div class="subject">
        <div class="title">
            No.{{.ID}}
            {{if .Subject}}{{.Subject}}{{else}}<span style="color:gray">无标题</span>{{end}}
        </div>
        <div class="title-info">
            <span>
                共 {{.T_TotalPosts}} 回复
                {{if .T_IsExpand}}
                <span>
                    , [ <a href="/t/{{.ID}}" target="_blank">展开</a> ] 以查看更多
                </span>
                {{else}}
                <span id="title-subject" style="display:none">{{.Subject}}</span>
                <script>document.title += " - " + $("#title-subject").text()</script>
                {{end}}
            </span>
        </div>
        {{if .T_IsAdmin}}
        <div>
            <a href="javascript:_submit(null,'!!free-reply={{.ID}}')">自由回复</a>
            <a href="javascript:_submit(null,'!!lock={{.ID}}')">锁定</a>
            <a href="javascript:_submit(null,'!!stick={{.ID}}')">置顶</a>
            <a href="javascript:_submit(null,'!!sage={{.ID}}')">SAGE</a>
            &nbsp;&bull;&nbsp;
            <a style="color:red" href="javascript:confirm()?_submit(null,'!!purge={{.ID}}'):0">永删</a>
        </div>
        {{end}}
    </div>
    {{end}}
    {{range .Posts}}
    <div class="post {{if .T_IsFirst}}post-first{{end}}" id="post-{{.LongID}}">
        <div class="info">
            <span class="toggle" onclick="_togglePost({{.LongID}})">[-]</span>
            <a href="{{if $.T_IsExpand}}/t/{{.Topic.ID}}#post-{{.LongID}}{{else}}javascript:_reply({{.LongID}}){{end}}">#{{.LongID}}</a>
            {{.Date}}
            <a href="/list?q={{.User}}" target="_blank">{{.User}}</a>

            {{ if $.T_IsAdmin }}
            <div style="font-size:12px">IP:
            <a href="/list?q={{.IP}}" target="_blank" style="font-size:12px">{{.IP}}</a>
            <a href="javascript:_submit(null, '!!delete={{.LongID}}')" style="font-size:12px;color:red">
                {{if .IsDeleted}} 恢复删除 {{else}} 删除 {{end}}
            </a>
            </div>
            {{ end }}
        </div>
        {{if .IsDeleted}}
            {{if $.T_IsAdmin}}
                <s>{{template "post1.html" .}}</s>
            {{else}}
                <div><s style="color: #aaa">已删除</s></div>
            {{end}}
        {{else}}
            {{template "post1.html" .}}
        {{end}}

        {{if .T_IsFirst}}
                <div class="topic-status">
                    {{if $.Archived}}<span class="icon-floppy"><b>该主题已被存档</b></span>{{end}}
                    {{if $.Locked}}<span class="icon-lock"><b>该主题已被锁定</b></span>{{end}}
                    {{if $.Sticky}}<span class="icon-pin"><b>置顶主题</b></span>{{end}}
                    {{if $.Saged}}<span class="icon-thumbs-down-alt" style="color:red"><b>该主题已被SAGE</b></span>{{end}}
                    {{if $.FreeReply}}<span class="icon-heart" style="color:#0097A7"><b>该主题下可自由回复</b></span>{{end}}
                </div>
        {{end}}
    </div>
    {{end}}
</div>
