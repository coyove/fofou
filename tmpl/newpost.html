<a class="newpost-click" href="#" onclick="$(this).hide();$('#newpost').show()">{{if .TopicID}}回复{{else}}新主题{{end}}</a>

<table cellspacing="0" id="newpost">
    <tbody>
        {{if not .TopicID}}
        <tr>
            <th><label for="subject">标题:</label></th>
            <td>
                <input maxlength="256" id="subject" type="edit">
            </td>
        </tr>
        {{else}}
        <script> window.TOPIC_ID = {{.TopicID}} </script>
        {{end}}

        <tr>
            <th>正文:</th>
            <td>
                <textarea id="message" rows="10" wrap="virtual"></textarea>
            </td>
        </tr>

        {{if not .Forum.NoImageUpload}}
        <tr>
            <th>图片:</th>
            <td>
                <input type="file" id="select-image" />
            </td>
        </tr>
        {{end}}

        <tr>
            <th>验证:</th>
            <td>
                <div id="recaptcha">...</div>
            </td>
        </tr>

        <tr>
            <td></td>
            <td>
                <button onclick='_submit(this)'>{{if .TopicID}}回复{{else}}新主题{{end}}</button>
                {{if .Forum.NoMoreNewUsers}}
                当前未持有cookie的匿名用户无法发言
                {{end}}
            </td> 
        </tr>
    </tbody>
</table>

<script src="https://www.recaptcha.net/recaptcha/api.js?onload=onloadRecaptcha&render=explicit" async defer></script>
<script>
    function onloadRecaptcha() {
        $("#message").on('focus', function() {
            if ($(this).prop('recaptcha')) return;
            grecaptcha.render("recaptcha", {"sitekey": "6LeNoZMUAAAAAOX2EGs8eewS_W73IqxWMtXFaZAq", "theme": "light"});
            $(this).prop('recaptcha', true);
        });
    }

$('#newpost').hide();
</script>


